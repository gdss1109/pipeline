node {

            stage('Checkout') {
                checkout scm
            }

            stage('Build') {
                container('maven') {
                    sh 'mvn clean install'
                }
            }

            stage('Build docker image') {
                DOCKER_IMAGE_REPO="https://hub.docker.com/u/maverick0803/hellowhale:${BUILD_NUMBER}"
                sh "docker build . -t $IMAGE_NAME"
                sh "docker login -u maverick0803 -p ${DOCKER_HUB}"
                sh "docker push $IMAGE_NAME"
                
                    }
            stage ('Deploy') {
                DOCKER_IMAGE_REPO="https://hub.docker.com/u/maverick0803/hellowhale:${BUILD_NUMBER}"
                sh "kubectl set image deployment/hellowhale hellowhale=$IMAGE_NAME"
            }
}
